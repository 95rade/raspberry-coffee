!function(t,i){"object"==typeof exports&&"object"==typeof module?module.exports=i():"function"==typeof define&&define.amd?define("boat-overview",[],i):"object"==typeof exports?exports["boat-overview"]=i():t["boat-overview"]=i()}(window,function(){return function(t){var i={};function e(s){if(i[s])return i[s].exports;var o=i[s]={i:s,l:!1,exports:{}};return t[s].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=t,e.c=i,e.d=function(t,i,s){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:s})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(e.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var o in t)e.d(s,o,function(i){return t[i]}.bind(null,o));return s},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},e.p="",e(e.s=0)}([function(t,i,e){"use strict";function s(t){return t*(Math.PI/180)}function o(t){return t*(180/Math.PI)}e.r(i);function h(t){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function a(t,i){return!i||"object"!==h(i)&&"function"!=typeof i?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):i}function n(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function l(t,i,e){return i&&n(t.prototype,i),e&&n(t,e),t}function u(t){var i="function"==typeof Map?new Map:void 0;return(u=function(t){if(null===t||(e=t,-1===Function.toString.call(e).indexOf("[native code]")))return t;var e;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==i){if(i.has(t))return i.get(t);i.set(t,s)}function s(){return c(t,arguments,p(this).constructor)}return s.prototype=Object.create(t.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),w(s,t)})(t)}function c(t,i,e){return(c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}()?Reflect.construct:function(t,i,e){var s=[null];s.push.apply(s,i);var o=new(Function.bind.apply(t,s));return e&&w(o,e.prototype),o}).apply(null,arguments)}function w(t,i){return(w=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f={displayBackgroundGradient:{from:"silver",to:"lightgray"},gridColor:"gray",twArrowColor:"black",bspArrowColor:"red",cmgArrowColor:"cyan",awArrowColor:"blue",gpsWsArrowColor:"coral",vmgArrowColor:"red",dDWArrowColor:"yellow",currentArrowColor:"royalblue",boatFillColor:"silver",boatOutlineColor:"blue",nmeaDataDisplayColor:"royalblue",calculatedDataDisplayColor:"darkcyan",vmgDataDisplayColor:"red",dDWDataDisplayColor:"yellow"},d=function(t){function i(){var t;r(this,i),(t=a(this,p(i).call(this)))._shadowRoot=t.attachShadow({mode:"open"}),t.canvas=document.createElement("canvas");var e=document.createElement("h1"),s=document.createTextNode("This is a Boat Overview Web Component, on an HTML5 canvas");return e.appendChild(s),t.canvas.appendChild(e),t.shadowRoot.appendChild(t.canvas),t._width=600,t._height=500,t._bsp=0,t._hdg=0,t._aws=0,t._awa=0,t._tws=0,t._twa=0,t._twd=0,t._vmg=0,t._cog=0,t._sog=0,t._cdr=0,t._csp=0,t._lwy=0,t._cmg=0,t._b2wp=0,t._Decl=0,t._dev=0,t._zoom=1,t._withCurrent=!1,t._withLabels=!0,t._withGPS=!0,t._withWind=!0,t._withTrueWind=!0,t._withVMG=!0,t._vmgOnWind=!0,t._withW=!1,t._boatShape="MONO",t._wpName="",t._previousClassName="",t.boatOverviewColorConfig=f,t.speedScale=10,t.WL_RATIO_COEFF=.75,t.BOAT_LENGTH=100,t}return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&w(t,i)}(i,u(HTMLElement)),l(i,null,[{key:"observedAttributes",get:function(){return["width","height","bsp","hdg","aws","awa","tws","twa","twd","vmg","sog","cog","cdr","csp","lwy","cmg","b2wp","decl","dev","with-current","with-gps","with-wind","with-true-wind","with-labels","with-vmg","vmg-on-wind","with-w","boat-shape","zoom-on-boat","wp-name"]}}]),l(i,[{key:"connectedCallback",value:function(){this.repaint()}},{key:"disconnectedCallback",value:function(){0}},{key:"attributeChangedCallback",value:function(t,i,e){switch(t){case"width":this._width=parseInt(e);break;case"height":this._height=parseInt(e);break;case"bsp":this._bsp=parseFloat(e);break;case"hdg":this._hdg=parseInt(e);break;case"aws":this._aws=parseFloat(e);break;case"awa":this._awa=parseInt(e);break;case"tws":this._tws=parseFloat(e);break;case"twa":this._twa=parseInt(e);break;case"twd":this._twd=parseInt(e);break;case"vmg":this._vmg=parseFloat(e);break;case"sog":this._sog=parseFloat(e);break;case"cog":this._cog=parseInt(e);break;case"cdr":this._cdr=parseInt(e);break;case"csp":this._csp=parseFloat(e);break;case"lwy":this._lwy=parseFloat(e);break;case"cmg":this._cmg=parseInt(e);break;case"b2wp":this._b2wp=parseFloat(e);break;case"decl":this._Decl=parseFloat(e);break;case"dev":this._dev=parseFloat(e);break;case"zoom-on-boat":this._zoom=parseFloat(e);break;case"with-current":this._withCurrent="true"===e;break;case"with-gps":this._withGPS="true"===e;break;case"with-true-wind":this._withTrueWind="true"===e;break;case"with-wind":this._withWind="true"===e;break;case"with-labels":this._withLabels="true"===e;break;case"with-vmg":this._withVMG="true"===e;break;case"vmg-on-wind":this._vmgOnWind="true"===e;break;case"with-w":this._withW="true"===e;break;case"boat-shape":console.log("BoatShape changing"),"MONO"!==e&&"CATA"!==e&&"TRI"!==e&&"PLANE"!==e||(this._boatShape=e);break;case"wp-name":this._wpName=e}this.repaint()}},{key:"adoptedCallback",value:function(){0}},{key:"getColorConfig",value:function(t){for(var i=f,e=t.split(" "),s=0;s<e.length;s++)for(var o=e[s],h=0;h<document.styleSheets.length;h++)try{for(var r=0;null!==document.styleSheets[h].cssRules&&r<document.styleSheets[h].cssRules.length;r++){var a=document.styleSheets[h].cssRules[r].selectorText;if(void 0!==a&&(a==="."+o||a.indexOf("."+o)>-1&&a.indexOf("boat-overview")>-1))document.styleSheets[h].cssRules[r].style.cssText.split(";").forEach(function(t){if(t.trim().length>0){var e=t.split(":"),s=e[0].trim(),o=e[1].trim();switch(s){case"--display-background-gradient-from":i.displayBackgroundGradient.from=o;break;case"--display-background-gradient-to":i.displayBackgroundGradient.to=o;break;case"--grid-color":i.gridColor=o;break;case"--tw-arrow-color":i.twArrowColor=o;break;case"--bsp-arrow-color":i.bspArrowColor=o;break;case"--cmg-arrow-color":i.cmgArrowColor=o;break;case"--aw-arrow-color":i.awArrowColor=o;break;case"--gps-ws-arrow-color":i.gpsWsArrowColor=o;break;case"--vmg-arrow-color":i.vmgArrowColor=o;break;case"--variation-arrow-color":i.dDWArrowColor=o;break;case"--current-arrow-color":i.currentArrowColor=o;break;case"--boat-fill-color":i.boatFillColor=o;break;case"--boat-outline-color":i.boatOutlineColor=o;break;case"--nmea-display-color":i.nmeaDataDisplayColor=o;break;case"--calculated-color":i.calculatedDataDisplayColor=o;break;case"--variation-display-color":i.dDWDataDisplayColor=o;break;case"--vmg-display-color":i.vmgDataDisplayColor=o}}})}}catch(t){}return i}},{key:"repaint",value:function(){this.drawBoatOverview()}},{key:"getCanvasCenter",value:function(){var t=this.width,i=this.height;return{x:t-Math.min(t,i)/2,y:i/2}}},{key:"drawTrueWind",value:function(t){var i=this.width,e=this.height,o=s(this.twd);t.beginPath();var h=this.getCanvasCenter(),r=h.x,a=h.y,n=this._zoom*this.tws*(Math.min(e,i)/2/this.speedScale),l=n*Math.sin(o),u=-n*Math.cos(o),c=new C(r+l,a+u,r,a);t.strokeStyle=this.boatOverviewColorConfig.twArrowColor,t.fillStyle=this.boatOverviewColorConfig.twArrowColor,t.lineWidth=5,c.drawWithAnemoArrowheads(t),t.closePath(),this._withLabels&&(t.font="bold 12px Arial",t.fillStyle=this.boatOverviewColorConfig.twArrowColor,t.fillText("TWS:"+this.tws.toFixed(2)+" kts",r+l,a+u),t.fillText("TWA:"+this.twa+"°",r+l,a+u+14))}},{key:"drawAppWind",value:function(t){for(var i=this.width,e=this.height,o=this._hdg+this.awa;o>360;)o-=360;var h=s(o);t.beginPath();var r=this.getCanvasCenter(),a=r.x,n=r.y,l=this._zoom*this.aws*(Math.min(e,i)/2/this.speedScale),u=l*Math.sin(h),c=-l*Math.cos(h),w=new C(a+u,n+c,a,n);t.strokeStyle=this.boatOverviewColorConfig.awArrowColor,t.fillStyle=this.boatOverviewColorConfig.awArrowColor,t.lineWidth=5,w.drawWithAnemoArrowheads(t),t.closePath(),this._withLabels&&(t.font="bold 12px Arial",t.fillStyle=this.boatOverviewColorConfig.awArrowColor,t.fillText("AWS:"+this.aws+" kts",a+u,n+c),t.fillText("AWA:"+this.awa+"°",a+u,n+c+14))}},{key:"drawBSP",value:function(t){if(0!==this._bsp){var i=this.width,e=this.height,o=s(this._hdg);t.beginPath();var h=this.getCanvasCenter(),r=h.x,a=h.y,n=this._zoom*this._bsp*(Math.min(e,i)/2/this.speedScale),l=n*Math.sin(o),u=-n*Math.cos(o),c=new C(r,a,r+l,a+u);t.strokeStyle=this.boatOverviewColorConfig.bspArrowColor,t.lineWidth=3,c.drawHollowArrow(t),t.closePath(),this._withLabels&&(t.font="bold 12px Arial",t.fillStyle=this.boatOverviewColorConfig.bspArrowColor,t.fillText("BSP:"+this._bsp.toFixed(2)+" kts",r+l,a+u),t.fillText("HDG:"+this._hdg.toFixed(0)+"°",r+l,a+u+14))}}},{key:"drawCMG",value:function(t){if(0!==this._bsp&&0!==this.lwy){var i=this.width,e=this.height,o=s(this._cmg);t.beginPath();var h=this.getCanvasCenter(),r=h.x,a=h.y,n=this._zoom*this._bsp*(Math.min(e,i)/2/this.speedScale),l=n*Math.sin(o),u=-n*Math.cos(o),c=new C(r,a,r+l,a+u);t.strokeStyle=this.boatOverviewColorConfig.cmgArrowColor,t.fillStyle=this.boatOverviewColorConfig.cmgArrowColor,t.lineWidth=5,c.drawWithArrowhead(t),t.closePath(),this._withLabels&&(t.font="bold 12px Arial",t.fillStyle=this.boatOverviewColorConfig.calculatedDataDisplayColor,t.fillText("CMG:"+this._cmg.toFixed(0)+"°",r+l,a+u))}}},{key:"drawNorths",value:function(t){if(0!==this._bsp&&(0!==this._Decl||0!==this._dev)){for(var i=this.width,e=this.height,o=this._Decl,h=o+this._dev;o<0;)o+=360;for(;h<0;)h+=360;var r=s(o),a=this.getCanvasCenter(),n=a.x,l=a.y,u=this._zoom*this._bsp*(Math.min(e,i)/2/this.speedScale),c=new C(n,l,n,l-1.1*u);t.beginPath(),t.strokeStyle=this.boatOverviewColorConfig.dDWArrowColor,t.fillStyle=this.boatOverviewColorConfig.dDWArrowColor,t.lineWidth=1,c.drawWithArrowhead(t),t.closePath(),this._withLabels&&(t.font="12px Arial",t.fillStyle=this.boatOverviewColorConfig.dDWDataDisplayColor,t.fillText("N",n,l-1.1*u)),t.beginPath();var w=u*Math.sin(r),p=-u*Math.cos(r);c=new C(n,l,n+w,l+p),t.lineWidth=5,c.drawWithArrowhead(t),t.closePath(),this._withLabels&&(t.font="bold 12px Arial",t.fillStyle=this.boatOverviewColorConfig.dDWDataDisplayColor,t.fillText("Mag N:"+o.toFixed(0)+"°",n+w,l+p));var f=s(h);t.beginPath(),w=.8*u*Math.sin(f),p=.8*-u*Math.cos(f),c=new C(n,l,n+w,l+p),t.strokeStyle=this.boatOverviewColorConfig.dDWArrowColor,t.fillStyle=this.boatOverviewColorConfig.dDWArrowColor,t.lineWidth=5,c.drawWithArrowhead(t),t.closePath(),this._withLabels&&(t.font="bold 12px Arial",t.fillStyle=this.boatOverviewColorConfig.dDWDataDisplayColor,t.fillText("Compass N:"+h.toFixed(0)+"°",n+w,l+p))}}},{key:"drawSOG",value:function(t){if(0!==this.sog){var i=this.width,e=this.height,o=s(this.cog);t.beginPath();var h=this.getCanvasCenter(),r=h.x,a=h.y,n=this._zoom*this.sog*(Math.min(e,i)/2/this.speedScale),l=n*Math.sin(o),u=-n*Math.cos(o),c=new C(r,a,r+l,a+u);t.strokeStyle=this.boatOverviewColorConfig.gpsWsArrowColor,t.fillStyle=this.boatOverviewColorConfig.gpsWsArrowColor,t.lineWidth=5,c.drawWithArrowhead(t),t.closePath(),this._withLabels&&(t.font="bold 12px Arial",t.fillStyle=this.boatOverviewColorConfig.gpsWsArrowColor,t.fillText("SOG:"+this.sog+" kts",r+l,a+u),t.fillText("COG:"+this.cog+"°",r+l,a+u+14),t.lineWidth=1)}}},{key:"drawVMG",value:function(t){var i=this.width,e=this.height,o=0;t.beginPath();var h=this.getCanvasCenter(),r=h.x,a=h.y;if(this.vmgOnWind)o=s(this.twd);else{o=s(this.b2wp),t.strokeStyle=this.boatOverviewColorConfig.vmgArrowColor,t.fillStyle=this.boatOverviewColorConfig.vmgArrowColor,t.lineWidth=1;var n=.75*Math.min(e,i)/2,l=n*Math.sin(o),u=-n*Math.cos(o);new C(r,a,r+l,a+u).drawWithArrowhead(t),t.fillText(this._wpName,r+l,a+u)}var c=this._zoom*this.vmg*(Math.min(e,i)/2/this.speedScale),w=c*Math.sin(o),p=-c*Math.cos(o),f=new C(r,a,r+w,a+p);if(t.strokeStyle=this.boatOverviewColorConfig.vmgArrowColor,t.fillStyle=this.boatOverviewColorConfig.vmgArrowColor,t.lineWidth=5,f.drawWithArrowhead(t),t.closePath(),this._withLabels&&(t.save(),t.font="bold 12px Arial",t.fillStyle=this.boatOverviewColorConfig.vmgArrowColor,t.fillText("VMG:"+this.vmg.toFixed(2)+" kts",r+w,a+p),t.restore()),void 0!==t.setLineDash){t.setLineDash([5]),t.moveTo(r+w,a+p);var d=s(this.cog),_=this._zoom*this.sog*(Math.min(e,i)/2/this.speedScale);w=_*Math.sin(d),p=-_*Math.cos(d),t.lineTo(r+w,a+p),t.lineWidth=1,t.stroke(),t.setLineDash([])}}},{key:"drawCurrent",value:function(t){if(0!==this.csp){var i=this.width,e=this.height,o=this.getCanvasCenter(),h=o.x,r=o.y,a=s(this._cmg),n=this._zoom*this._bsp*(Math.min(e,i)/2/this.speedScale),l=n*Math.sin(a),u=-n*Math.cos(a),c=s(this.cog),w=this._zoom*this.sog*(Math.min(e,i)/2/this.speedScale),p=w*Math.sin(c),f=-w*Math.cos(c);t.beginPath();var d=new C(h+l,r+u,h+p,r+f);t.strokeStyle=this.boatOverviewColorConfig.currentArrowColor,t.fillStyle=this.boatOverviewColorConfig.currentArrowColor,t.lineWidth=5,d.drawWithArrowhead(t),t.closePath(),this._withLabels&&(t.font="bold 12px Arial",t.fillStyle=this.boatOverviewColorConfig.currentArrowColor,t.fillText("CSP:"+this.csp.toFixed(2)+" kts",h+p,r+f+28),t.fillText("CDR:"+this.cdr.toFixed(0)+"°",h+p,r+f+42))}}},{key:"drawVW",value:function(t){if(0!==this.sog){for(var i=this.width,e=this.height,o=this.getCanvasCenter(),h=o.x,r=o.y,a=this._hdg+this.awa;a>360;)a-=360;var n=s(a);t.beginPath();var l=this._zoom*this.aws*(Math.min(e,i)/2/this.speedScale),u=l*Math.sin(n),c=-l*Math.cos(n),w=s(this.twd),p=this._zoom*this.tws*(Math.min(e,i)/2/this.speedScale),f=p*Math.sin(w),d=-p*Math.cos(w);t.beginPath();var _=new C(h+u,r+c,h+f,r+d);t.strokeStyle=this.boatOverviewColorConfig.gpsWsArrowColor,t.fillStyle=this.boatOverviewColorConfig.gpsWsArrowColor,t.lineWidth=5,_.drawWithAnemoArrowheads(t),t.closePath()}}},{key:"drawBoat",value:function(t,i){var e=[],o=[],h=this.BOAT_LENGTH*this._zoom;"MONO"===this.boatShape?(e.push(0*this.WL_RATIO_COEFF),e.push(this.WL_RATIO_COEFF*(1*h)/7),e.push(this.WL_RATIO_COEFF*(2*h)/7),e.push(this.WL_RATIO_COEFF*(2*h)/7),e.push(this.WL_RATIO_COEFF*(1.5*h)/7),e.push(this.WL_RATIO_COEFF*(-1.5*h)/7),e.push(this.WL_RATIO_COEFF*(-2*h)/7),e.push(this.WL_RATIO_COEFF*(-2*h)/7),e.push(this.WL_RATIO_COEFF*(-1*h)/7),o.push(-4*h/7),o.push(-3*h/7),o.push(-1*h/7),o.push(1*h/7),o.push(3*h/7),o.push(3*h/7),o.push(1*h/7),o.push(-1*h/7),o.push(-3*h/7)):"CATA"===this.boatShape?(e.push(0*this.WL_RATIO_COEFF),e.push(this.WL_RATIO_COEFF*(1*h)/7),e.push(this.WL_RATIO_COEFF*(1.5*h)/7),e.push(this.WL_RATIO_COEFF*(2*h)/7),e.push(this.WL_RATIO_COEFF*(2*h)/7),e.push(this.WL_RATIO_COEFF*(2*h)/7),e.push(this.WL_RATIO_COEFF*(1.8*h)/7),e.push(this.WL_RATIO_COEFF*(1.2*h)/7),e.push(this.WL_RATIO_COEFF*(1*h)/7),e.push(this.WL_RATIO_COEFF*(0*h)/7),e.push(this.WL_RATIO_COEFF*(-0*h)/7),e.push(this.WL_RATIO_COEFF*(-1*h)/7),e.push(this.WL_RATIO_COEFF*(-1.2*h)/7),e.push(this.WL_RATIO_COEFF*(-1.8*h)/7),e.push(this.WL_RATIO_COEFF*(-2*h)/7),e.push(this.WL_RATIO_COEFF*(-2*h)/7),e.push(this.WL_RATIO_COEFF*(-2*h)/7),e.push(this.WL_RATIO_COEFF*(-1.5*h)/7),e.push(this.WL_RATIO_COEFF*(-1*h)/7),o.push(-1*h/7),o.push(-1*h/7),o.push(-4*h/7),o.push(-1*h/7),o.push(0*h/7),o.push(1*h/7),o.push(3*h/7),o.push(3*h/7),o.push(1*h/7),o.push(1*h/7),o.push(1*h/7),o.push(1*h/7),o.push(3*h/7),o.push(3*h/7),o.push(1*h/7),o.push(0*h/7),o.push(-1*h/7),o.push(-4*h/7),o.push(-1*h/7)):"TRI"===this.boatShape?(e.push(0*this.WL_RATIO_COEFF),e.push(this.WL_RATIO_COEFF*(.3*h)/7),e.push(this.WL_RATIO_COEFF*(.6*h)/7),e.push(this.WL_RATIO_COEFF*(1.6*h)/7),e.push(this.WL_RATIO_COEFF*(1.8*h)/7),e.push(this.WL_RATIO_COEFF*(2*h)/7),e.push(this.WL_RATIO_COEFF*(2*h)/7),e.push(this.WL_RATIO_COEFF*(1.9*h)/7),e.push(this.WL_RATIO_COEFF*(1.7*h)/7),e.push(this.WL_RATIO_COEFF*(1.6*h)/7),e.push(this.WL_RATIO_COEFF*(.6*h)/7),e.push(this.WL_RATIO_COEFF*(.3*h)/7),e.push(this.WL_RATIO_COEFF*(-.3*h)/7),e.push(this.WL_RATIO_COEFF*(-.6*h)/7),e.push(this.WL_RATIO_COEFF*(-1.6*h)/7),e.push(this.WL_RATIO_COEFF*(-1.7*h)/7),e.push(this.WL_RATIO_COEFF*(-1.9*h)/7),e.push(this.WL_RATIO_COEFF*(-2*h)/7),e.push(this.WL_RATIO_COEFF*(-2*h)/7),e.push(this.WL_RATIO_COEFF*(-1.8*h)/7),e.push(this.WL_RATIO_COEFF*(-1.6*h)/7),e.push(this.WL_RATIO_COEFF*(-.6*h)/7),e.push(this.WL_RATIO_COEFF*(-.3*h)/7),o.push(-4*h/7),o.push(-3*h/7),o.push(-1*h/7),o.push(-1*h/7),o.push(-2.6*h/7),o.push(-1.5*h/7),o.push(1.5*h/7),o.push(2.5*h/7),o.push(2.5*h/7),o.push(1*h/7),o.push(1*h/7),o.push(3*h/7),o.push(3*h/7),o.push(1*h/7),o.push(1*h/7),o.push(2.5*h/7),o.push(2.5*h/7),o.push(1.5*h/7),o.push(-1.5*h/7),o.push(-2.6*h/7),o.push(-1*h/7),o.push(-1*h/7),o.push(-3*h/7)):"PLANE"===this.boatShape&&(e.push(0*this.WL_RATIO_COEFF),e.push(this.WL_RATIO_COEFF*(.3*h)/7),e.push(this.WL_RATIO_COEFF*(.6*h)/7),e.push(this.WL_RATIO_COEFF*(4*h)/7),e.push(this.WL_RATIO_COEFF*(4*h)/7),e.push(this.WL_RATIO_COEFF*(.6*h)/7),e.push(this.WL_RATIO_COEFF*(.3*h)/7),e.push(this.WL_RATIO_COEFF*(2*h)/7),e.push(this.WL_RATIO_COEFF*(2*h)/7),e.push(this.WL_RATIO_COEFF*(.1*h)/7),e.push(this.WL_RATIO_COEFF*(-.1*h)/7),e.push(this.WL_RATIO_COEFF*(-2*h)/7),e.push(this.WL_RATIO_COEFF*(-2*h)/7),e.push(this.WL_RATIO_COEFF*(-.3*h)/7),e.push(this.WL_RATIO_COEFF*(-.6*h)/7),e.push(this.WL_RATIO_COEFF*(-4*h)/7),e.push(this.WL_RATIO_COEFF*(-4*h)/7),e.push(this.WL_RATIO_COEFF*(-.6*h)/7),e.push(this.WL_RATIO_COEFF*(-.3*h)/7),o.push(-4*h/7),o.push(-3*h/7),o.push(-2*h/7),o.push(-1*h/7),o.push(0*h/7),o.push(-.5*h/7),o.push(1.8*h/7),o.push(2.5*h/7),o.push(3*h/7),o.push(2.8*h/7),o.push(2.8*h/7),o.push(3*h/7),o.push(2.5*h/7),o.push(1.8*h/7),o.push(-.5*h/7),o.push(0*h/7),o.push(-1*h/7),o.push(-2*h/7),o.push(-3*h/7));for(var r=[],a=[],n=this.getCanvasCenter(),l=n.x,u=n.y,c=0;c<e.length;c++){var w=e[c]*Math.cos(s(i))+o[c]*-Math.sin(s(i)),p=e[c]*Math.sin(s(i))+o[c]*Math.cos(s(i));r.push(Math.round(l+w)),a.push(Math.round(u+p))}t.fillStyle=this.boatOverviewColorConfig.boatFillColor,t.beginPath(),t.moveTo(r[0],a[0]);for(var f=1;f<r.length;f++)t.lineTo(r[f],a[f]);t.closePath(),t.fill(),t.strokeStyle=this.boatOverviewColorConfig.boatOutlineColor,t.lineWidth=2,t.stroke()}},{key:"drawBoatOverview",value:function(){var t=this.className;this._previousClassName;try{this.boatOverviewColorConfig=this.getColorConfig(t)}catch(t){console.log(t)}this._previousClassName=t;var i=this.canvas.getContext("2d");if(0!==this.width&&0!==this.height){this.canvas.width=this._width,this.canvas.height=this._height;var e=i.createLinearGradient(0,5,0,this.height);e.addColorStop(0,this.boatOverviewColorConfig.displayBackgroundGradient.from),e.addColorStop(1,this.boatOverviewColorConfig.displayBackgroundGradient.to),i.fillStyle=e,i.fillRect(0,0,this.width,this.height);var s=5;this._withGPS&&(s=Math.max(s,this.sog)),s=Math.max(s,this._bsp),this._withGPS&&this._withWind&&this._withTrueWind&&(s=Math.max(s,this.tws)),this._withWind&&(s=Math.max(s,this.aws)),this.speedScale=5*Math.ceil(s/5);var o=this._width,h=this._height,r=this.getCanvasCenter(),a=r.x,n=r.y;i.strokeStyle=this.boatOverviewColorConfig.gridColor;for(var l=1;l<=this.speedScale;l++){var u=this._zoom*Math.round(l*(Math.min(h,o)/2/this.speedScale));i.beginPath(),i.lineWidth=l%5==0?3:1,i.arc(a,n,u,0,2*Math.PI),i.closePath(),i.stroke()}this.drawBoat(i,this._hdg),this._withWind&&this._withTrueWind&&this._withGPS&&(this.drawTrueWind(i),this.drawVW(i)),this._withWind&&this.drawAppWind(i),this.drawBSP(i),this._withW&&this.drawNorths(i),this.drawCMG(i),this._withGPS&&this.drawSOG(i),this._withCurrent&&this._withGPS&&this.drawCurrent(i),this._withVMG&&this._withGPS&&this.drawVMG(i),i.fillStyle=this.boatOverviewColorConfig.nmeaDataDisplayColor,i.font="bold 16px Courier New";var c=20;if(i.fillText("BSP",10,c),i.fillText(this._bsp+" kts",90,c),c+=18,i.fillText("HDG",10,c),i.fillText(this._hdg.toFixed(0)+"° True",90,c),this._withWind&&(c+=18,i.fillText("AWS",10,c),i.fillText(this.aws+" kts",90,c),c+=18,i.fillText("AWA",10,c),i.fillText(this.awa+"°",90,c)),this._withGPS&&(i.fillStyle=this.boatOverviewColorConfig.gpsWsArrowColor,c+=18,i.fillText("COG",10,c),i.fillText(this.cog.toFixed(0)+"°",90,c),c+=18,i.fillText("SOG",10,c),i.fillText(this.sog.toFixed(2)+" kts",90,c)),i.fillStyle=this.boatOverviewColorConfig.calculatedDataDisplayColor,this._withWind&&this._withTrueWind&&this._withGPS&&(c+=18,i.fillText("TWS",10,c),i.fillText(this.tws.toFixed(2)+" kts",90,c),c+=18,i.fillText("TWA",10,c),i.fillText(this.twa+"°",90,c),c+=18,i.fillText("TWD",10,c),i.fillText(this.twd+"°",90,c)),this._withCurrent&&this._withGPS&&(c+=18,i.fillText("CDR",10,c),i.fillText(this.cdr.toFixed(0)+"°",90,c),c+=18,i.fillText("CSP",10,c),i.fillText(this.csp.toFixed(2)+" kts",90,c)),c+=18,i.fillText("leeway",10,c),i.fillText(this.lwy.toFixed(2)+"°",90,c),c+=18,i.fillText("CMG",10,c),i.fillText(this._cmg.toFixed(0)+"°",90,c),this._withVMG&&this._withGPS){var w=", ";this.vmgOnWind?w+="on wind":w+="on WP ["+this._wpName+"]",i.fillStyle=this.boatOverviewColorConfig.vmgDataDisplayColor,c+=18,i.fillText("VMG",10,c),i.fillText(this.vmg.toFixed(2)+" kts"+w,90,c)}if(this._withW){for(var p=this._hdg-this._Decl,f=p-this._dev;p<0;)p+=360;for(;f<0;)f+=360;i.fillStyle=this.boatOverviewColorConfig.dDWDataDisplayColor,c+=18,i.fillText("D",10,c),i.fillText(this.Decl.toFixed(1)+"°",90,c),c+=18,i.fillText("d",10,c),i.fillText(this.dev.toFixed(1)+"°",90,c),c+=18,i.fillText("W",10,c),i.fillText((this.Decl+this.dev).toFixed(1)+"°",90,c),c+=18,i.fillText("HDM",10,c),i.fillText(p.toFixed(1)+"°",90,c),c+=18,i.fillText("HDC",10,c),i.fillText(f.toFixed(1)+"°",90,c)}}}},{key:"width",set:function(t){this.setAttribute("width",t)},get:function(){return this._width}},{key:"height",set:function(t){this.setAttribute("height",t)},get:function(){return this._height}},{key:"bsp",set:function(t){this.setAttribute("bsp",t)},get:function(){return this._bsp}},{key:"hdg",set:function(t){this.setAttribute("hdg",t)},get:function(){return this._hdg}},{key:"aws",set:function(t){this.setAttribute("aws",t)},get:function(){return this._aws}},{key:"awa",set:function(t){this.setAttribute("awa",t)},get:function(){return this._awa}},{key:"tws",set:function(t){this.setAttribute("tws",t)},get:function(){return this._tws}},{key:"twa",set:function(t){this.setAttribute("twa",t)},get:function(){return this._twa}},{key:"twd",set:function(t){this.setAttribute("twd",t)},get:function(){return this._twd}},{key:"vmg",set:function(t){this.setAttribute("vmg",t)},get:function(){return this._vmg}},{key:"cog",set:function(t){this.setAttribute("cog",t)},get:function(){return this._cog}},{key:"sog",set:function(t){this.setAttribute("sog",t)},get:function(){return this._sog}},{key:"cdr",set:function(t){this.setAttribute("cdr",t)},get:function(){return this._cdr}},{key:"csp",set:function(t){this.setAttribute("csp",t)},get:function(){return this._csp}},{key:"lwy",set:function(t){this.setAttribute("lwy",t)},get:function(){return this._lwy}},{key:"cmg",set:function(t){this.setAttribute("cmg",t)},get:function(){return this._cmg}},{key:"b2wp",set:function(t){this.setAttribute("b2wp",t)},get:function(){return this._b2wp}},{key:"Decl",set:function(t){this.setAttribute("decl",t)},get:function(){return this._Decl}},{key:"dev",set:function(t){this.setAttribute("dev",t)},get:function(){return this._dev}},{key:"zoomOnBoat",set:function(t){this.setAttribute("zoom-on-boat",t)},get:function(){return this._zoom}},{key:"withGPS",set:function(t){this.setAttribute("with-gps",t)},get:function(){return this._withGPS}},{key:"withCurrent",set:function(t){this.setAttribute("with-current",t)},get:function(){return this._withCurrent}},{key:"withTrueWind",set:function(t){this.setAttribute("with-true-wind",t)},get:function(){return this._withTrueWind}},{key:"withWind",set:function(t){this.setAttribute("with-wind",t)},get:function(){return this._withWind}},{key:"withLabels",set:function(t){this.setAttribute("with-labels",t)},get:function(){return this._withLabels}},{key:"withVMG",set:function(t){this.setAttribute("with-vmg",t)},get:function(){return this._withVMG}},{key:"vmgOnWind",set:function(t){this.setAttribute("vmg-on-wind",t)},get:function(){return this._vmgOnWind}},{key:"withW",set:function(t){this.setAttribute("with-w",t)},get:function(){return this._withW}},{key:"wpName",set:function(t){this.setAttribute("wp-name",t)},get:function(){return this._wpName}},{key:"boatShape",set:function(t){this.setAttribute("boat-shape",t)},get:function(){return this._boatShape}},{key:"shadowRoot",set:function(t){this._shadowRoot=t},get:function(){return this._shadowRoot}}]),i}(),_=function t(i,e){r(this,t),this.x=i,this.y=e},C=function(){function t(i,e,s,o){r(this,t),this.x1=i,this.y1=e,this.x2=s,this.y2=o,this.HEAD_LENGTH=20,this.HEAD_WIDTH=6}return l(t,[{key:"rotate",value:function(t,i){return new _(Math.round(t.x*Math.cos(s(i))+t.y*Math.sin(s(i))),Math.round(t.x*-Math.sin(s(i))+t.y*Math.cos(s(i))))}},{key:"drawWithArrowhead",value:function(t){this.drawWithArrowheads(t,!1)}},{key:"drawWithArrowheads",value:function(t,i){if(void 0===i&&(i=!0),t.beginPath(),t.moveTo(this.x1,this.y1),t.lineTo(this.x2,this.y2),t.stroke(),i){var e=Math.atan((this.y2-this.y1)/(this.x2-this.x1));e+=(this.x2>this.x1?-90:90)*Math.PI/180,this.drawArrowhead(t,this.x1,this.y1,e)}var s=Math.atan((this.y2-this.y1)/(this.x2-this.x1));s+=(this.x2>this.x1?90:-90)*Math.PI/180,this.drawArrowhead(t,this.x2,this.y2,s)}},{key:"drawWithAnemoArrowheads",value:function(t){t.beginPath(),t.moveTo(this.x1,this.y1),t.lineTo(this.x2,this.y2),t.stroke();var i=Math.atan((this.y2-this.y1)/(this.x2-this.x1));i+=(this.x2>this.x1?90:-90)*Math.PI/180,this.drawArrowhead(t,this.x2-(this.x2-this.x1)/2,this.y2-(this.y2-this.y1)/2,i)}},{key:"drawHollowArrow",value:function(t){var i,e,s,h,r,a,n,l,u=function(t,i){let e=0;for(0!=i&&(e=o(Math.atan(t/i))),(t<=0||i<=0)&&(t>0&&i<0?e+=180:t<0&&i>0?e+=360:t<0&&i<0?e+=180:0==t?e=i>0?0:180:0==i&&(e=t>0?90:270)),e+=180;e>=360;)e-=360;return e}(this.x1-this.x2,this.y2-this.y1),c=Math.sqrt((this.x1-this.x2)*(this.x1-this.x2)+(this.y2-this.y1)*(this.y2-this.y1));i=new _(0,0),e=new _(-5,0),s=new _(-5,-Math.round(c-30)),h=new _(-10,-Math.round(c-30)),r=new _(0,-Math.round(c)),a=new _(10,-Math.round(c-30)),n=new _(5,-Math.round(c-30)),l=new _(5,0),i=this.rotate(i,-u),e=this.rotate(e,-u),s=this.rotate(s,-u),h=this.rotate(h,-u),r=this.rotate(r,-u),a=this.rotate(a,-u),n=this.rotate(n,-u),l=this.rotate(l,-u);var w=[],p=[];w.push(this.x1+i.x),w.push(this.x1+e.x),w.push(this.x1+s.x),w.push(this.x1+h.x),w.push(this.x1+r.x),w.push(this.x1+a.x),w.push(this.x1+n.x),w.push(this.x1+l.x),p.push(this.y1+i.y),p.push(this.y1+e.y),p.push(this.y1+s.y),p.push(this.y1+h.y),p.push(this.y1+r.y),p.push(this.y1+a.y),p.push(this.y1+n.y),p.push(this.y1+l.y),t.beginPath(),t.moveTo(w[0],p[0]);for(var f=1;f<w.length;f++)t.lineTo(w[f],p[f]);t.closePath(),t.stroke()}},{key:"drawArrowhead",value:function(t,i,e,s){t.save(),t.beginPath(),t.translate(i,e),t.rotate(s),t.moveTo(0,0),t.lineTo(this.HEAD_WIDTH,this.HEAD_LENGTH),t.lineTo(-this.HEAD_WIDTH,this.HEAD_LENGTH),t.closePath(),t.restore(),t.fill()}}]),t}();window.customElements.define("boat-overview",d)}])});
//# sourceMappingURL=boat-overview.min.js.map