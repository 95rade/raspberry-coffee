<div style="padding: 5px; background:#ffffcc; border-radius:5px; border:1px solid #CCC; margin-top:10px; margin-left: 10px; margin-right: 10px;">
  <dl>
    <dt><h5>What is True Wind and Current calculation?</h5></dt>
    <dd>
      <div id="true-wind" style="display: block;">
        The calculations of the True Wind and the Current are not very complicated, but they rely on several parameters. Determining the values of those parameters is absolutely <b><i>crucial</i></b>.
        <br>
        <p style="text-align: center;">
          <img src="img/tw.png" width="634" height="424" alt="All the calculation elements" title="All the calculation elements">
        </p>
        The wind measured by the instruments is the <b>Apparent Wind</b>. This is the vectorial combination of the <b>True Wind</b> with the <b>Boat Speed and Course <i>over the ground</i></b>. This is the wind you feel when riding your bike in no wind. You feel wind even if there is none.
        <br>
        The <b>True Wind</b> can be calculated by triangulation, as seen above. The <b>Apparent Wind</b> is in blue, the <b>True Wind</b> is in black, and the pink vector is generated by the boat speed and heading <i>over the ground</i>. And this is where it can become tricky.
        <p style="text-align: center; align: center;">
          <table style="margin: auto;">
            <tr>
              <td><img src="img/headings.png" width="397" height="400" alt="All the headings" title="All the headings"></td>
              <td><img src="img/all.vectors.png" width="450" height="400" alt="All the calculation elements" title="All the calculation elements"></td>
            </tr>
          </table>
        </p>
        You need the <b>True North</b> for any further computation, but what you have on board is a compass, showing you its <b>Compass' North</b>.
        <ul>
          <li>The <b>True North</b> is the North of the charts</li>
          <li>Between the <b>True North</b> and the <b>Magnetic North</b> is the <b>Magnetic Declination (D)</b>, that varies with the date and the location</li>
          <li>Between the <b>Magnetic North</b> and the <b>Compass' North</b> is the <b>Compass' deviation (d)</b>, generated by the magnetic masses on board. It depends on the boat, and on its heading. You have on board a <i>deviation curve</i> that tells you the value of the deviation based on your heading.</li>
          <li>The algebraic sum of the deviation and the Declination is called the <b>Variation</b>, noted <b>W</b>.</li>
          <li>Once you have the <b>True Heading</b>, you need to get the <b>Course Made Good</b>, by adding (or substracting) the <b>leeway</b> to it. The <b>leeway</b> is generated by the wind and waves, it has to be <i>estimated</i> by the navigator. The leeway is an angle.</li>
          <li>And between the <b>Course Made Good</b> and the <b>Course Over Ground</b>, is the current. As seen above, the current is a vector (not an angle).</li>
        </ul>
        The value of the <b>deviation (d)</b> is also a parameter, impacting the value of the computing data like
        <ul>
          <li>True Heading</li>
          <li>Course Made Good</li>
          <li>Course Over Ground</li>
        </ul>
        Elaborating the right deviation curve is an important step of the calibration.
        <br/>
        It is <i><b>not</b></i> possible to come up with an accurate computation of the current <i>without</i> the right estimation of the leeway.
        <br>
        In theory, the current could be calculated by triangulation - like the true wind from the apparent Wind.
        <br>
        In practice, it is much more accurate over time.
        <p style="text-align: center;">
          <img src="img/current.png" width="634" height="424" alt="Current over Time" title="Current over Time">
        </p>
        On the figure above:
        <ul>
          <li>The left pane shows the triangulation</li>
          <li>The middle pane compares the Course Over Ground (from the GPS) and the estimated position based on all the parameters above <b>on a 1 minute period</b></li>
          <li>The right pane compares the Course Over Ground (from the GPS) and the estimated position based on all the parameters above <b>on a 10 minute period</b></li>
        </ul>
        The experience does prove that the estimation on a several minutes period is much more accurate than the triangulation, mostly because of the movements of the boat, that impact the data read by the wind vane.
        <br><br>
        Honestly, <b>no</b> embarqued electronic station can come up with a right evaluation of
        <ul>
          <li>The compass' deviation</li>
          <li>The leeway</li>
          <li>The current</li>
        </ul>
        Being able to <i>compute</i> those data, and then <i>inject</i> them in the NMEA stream is a real asset (current will be <code>VDR</code> - Set and Drift). The Raspberry PI is perfectly equiped to take care of all that, and for a ridiculous energy comsumption.
      </div>
    </dd>
  </dl>
</div>

<div style="padding: 5px; background:#ffffcc; border-radius:5px; border:1px solid #CCC; margin-top:10px; margin-left: 10px; margin-right: 10px;">
<dl>
  <dt><h5>What to calculate True Wind with?</h5></dt>
  <dd>
    <div id="true-wind-calc" style="display: block;">
      This would seem obvious to some, but absurd to others. That's why we have this small explanation here.
      <br><br>
      For years, it was admitted that the true wind should be calculated with the <b>C</b>ourse <b>M</b>ade <b>G</b>ood (CMG), the <b>A</b>pparent <b>W</b>ind <b>A</b>ngle (AWA), <b>A</b>pparent <b>W</b>ind <b>S</b>peed (AWS), and <b>B</b>oat <b>SP</b>eed (BSP). The AWS and AWA are returned by the wind vane and anemometer, BSP by the speedometer (BSP is also called <b>S</b>peed <b>T</b>hrough <b>W</b>ater (STW)). The elaboration of the CMG is not trivial, as explained just above.
      <br>
      The reason for that is probably because this is all we had at that time.
      <br><br>
      <i>But picture that (and draw a sketch, if needed):</i><br>
      You are "sailing" in <b>no</b> wind <i>at all</i> (like in the San Francisco Bay in winter), and a 5 knot current is taking you out of the Bay (or inside, or wherever).
      <br>
      BSP is zero, <b>T</b>rue <b>W</b>ind <b>S</b>peed (TWS) is zero too, and in this case, AWS would be the speed of the current (5 knots), the AWA will depend on (but be equivalent to) the direction the current is taking you to.
      <br>
      If you calculate the TWS based on BSP, CMG, AWA and AWS, you will find a TWS equal to AWS - which is wrong because there is <i><u>no</u> wind</i>, and a wrong TWA (and <b>T</b>rue <b>W</b>ind <b>D</b>irection (TWD) as well, no wind has no direction).
      <br>
      <b><i>But</i></b>, if you replace BSP with <b>S</b>peed <b>O</b>ver <b>G</b>round (SOG), and CMG with <b>C</b>ourse <b>O</b>ver <b>G</b>round (COG), you are back in business; COG is the current direction, SOG is the current speed.
      <br>
      Think about it.
      <br><br>
      This obviously requires the knowledge of SOG &amp; COG, returned by a GPS.
      <br><br>
      When the boat is moving, that eventually means that an accurate TWA and TWS (and TWD) is elaborated by a accurate knowledge of
      <ul>
        <li>COG</li>
        <li>SOG</li>
        <li>AWA</li>
        <li>AWS</li>
        <li>CMG</li>
      </ul>
      In short: this is not trivial. At all, by far, mostly because of CMG (see above for details).
      <br>
      You will notice that in the Console, you have the possibility to compute the True Wind from (BSP, CMG), or from (SOG, COG). This way you can have an idea of the difference it generates...
    </div>
  </dd>
</dl>
</div>
