<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="Pragma" content="no-cache, must-revalidate">
    <title>RasPi Camera</title>
    <link rel="stylesheet" href="css/stylesheet.css" type="text/css"/>
    <script type="text/javascript">

  var calledBy = document.location.toString();
  var machine, port, secured;
  var regExp = new RegExp("(http|ws)(.?):[/]{2}([^/|^:]*):?(\\d*)/(.*)");
  var matches = regExp.exec(calledBy);
  try {
  //scheme  = matches[1];
    secured = matches[2];
    machine = matches[3];
    port    = matches[4];
  //query   = matches[5];
  } catch (err) {}

  var reset = function() { // Reset the screen
    contentFld.innerHTML = "";
  };

  var resetStatus = function() {
    statusFld.innerHTML = "";
  };
      </script>
      <script type="text/javascript">
  /*
   * Init the App here
   */
  var contentFld, inputFld, statusFld, promptFld;

  window.onload = function() {
    contentFld = document.getElementById('content');
    inputFld   = document.getElementById('input');
    statusFld  = document.getElementById('status');
    promptFld  = document.getElementById('prompt');

    promptFld.innerHTML = 'Ready';

//  setInterval(updateImage, 2000);
  };

  var updateImage = function() {
    console.log('Refreshing...');
    document.getElementById("snap").src.reload();
  };

//setInterval(updateImage, 2000);

    </script>
  </head>
  <body>
    <table width="100%" border="0">
      <tr>
        <td valign="top"><h2>RasPi Camera</h2></td>
        <td align="right" valign="bottom"><a href="" onclick="javascript:reset(); return false;" title="Clear messages"><small>Reset</small></a></td>
      </tr>
      <tr>
        <td valign="top" colspan="2" align="center">
          <iframe id="snap" src="snap.html" width="640" height="480" frameborder="0" scrolling="no">What?</iframe>
        </td>
      </tr>
      <tr>
        <td valign="top" colspan="2">
          <div id="content" style="padding:5px; background:#ddd; border-radius:5px; overflow-y: scroll; border:1px solid #CCC; margin-top:10px; height: 160px;"></div>
        </td>
      </tr>
      <tr>
        <td align="left" colspan="2">
          <div id="prompt" style="width:200px; display:block; float:left; margin-top:15px;">Connecting...</div>
          <input type="text" id="input" style="border-radius:2px; border:1px solid #ccc; margin-top:10px; padding:5px; width:400px;" placeholder="Type your message here"/>
          <button onclick="javascript:send(document.getElementById('input').value);">Send</button>
        </td>
      </tr>
      <tr>
        <td align="left" colspan="2">
          <div id="status" style="padding:5px; background:#ddd; border-radius:5px; overflow-y: scroll; border:1px solid #CCC; margin-top:10px; height: 80px;">
              <i>Status will go here when needed...</i>
          </div>
        </td>
      </tr>
      <tr>
        <td valign="top" align="right" colspan="2"><a href="" onclick="javascript:resetStatus(); return false;" title="Clear status board"><small>Reset Status</small></a></td>
      </tr>
    </table>
    <hr>
  </body>
</html>
